<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Eventos Cercanos</title>
	<link rel="stylesheet" href="./css/estilo.css" />
	<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body>
	<!-- üîπ NAV SUPERIOR -->
	<header>
		<nav>
			<div id="barra-busqueda">
				<input id="pac-input" type="text" placeholder="Buscar eventos o lugares..." />
			</div>
		</nav>
	</header>
	<!-- üîπ SIDEBAR -->
	<div class="sidebar">
		<h5>üéüÔ∏è EventosApp</h5>

		<a href="#" data-bs-toggle="collapse" data-bs-target="#usuarioMenu" aria-expanded="false">
			üë§ Organizadores
		</a>
		<div class="collapse ps-3" id="usuarioMenu">
			<!-- Cambiar din√°micamente seg√∫n sesi√≥n -->
		</div>
		<a href="#" data-bs-toggle="modal" data-bs-target="#filtrosModal">
			üß≠ Filtros
		</a>
	</div>


	<!--  MODAL LOGIN  -->
	<div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-sm modal-dialog-centered">
			<div class="modal-content">
				<form id="formLogin" class="p-0">
					<div class="modal-header bg-primary text-white">
						<h5 class="modal-title">Iniciar sesi√≥n</h5>
						<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
					</div>
					<div class="modal-body">
						<div class="mb-3">
							<label for="loginEmail" class="form-label">Email</label>
							<input type="email" id="loginEmail" name="email" class="form-control" required>
						</div>
						<div class="mb-3">
							<label for="loginPassword" class="form-label">Contrase√±a</label>
							<div class="input-group">
								<input type="password" id="loginPassword" name="password" class="form-control" required
									minlength="6">
								<button class="btn btn-light border" type="button" data-toggle-password><i
										class="bi bi-eye-slash" data-icon></i></button>
							</div>
						</div>
						<div id="loginError" class="alert alert-danger d-none" role="alert"></div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
						<button type="submit" class="btn btn-primary">Entrar</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!--  MODAL REGISTRO (Organizador)  -->
	<div class="modal fade" id="registroModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-md modal-dialog-centered">
			<div class="modal-content">
				<form id="formRegistro" class="p-0">
					<div class="modal-header bg-success text-white">
						<h5 class="modal-title" id="registroModalTitulo">Registro - Organizador</h5>
						<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
					</div>

					<div class="modal-body">
						<div id="registroError" class="alert alert-danger d-none" role="alert"></div>

						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label">Nombre</label>
								<input type="text" name="nombre" id="regNombre" class="form-control" required
									maxlength="50">
								<small class="text-danger d-none" id="errorNombre"></small>

							</div>
							<div class="col-md-6">
								<label class="form-label">Apellido</label>
								<input type="text" name="apellido" id="regApellido" class="form-control" required
									maxlength="50">
								<small class="text-danger d-none" id="errorApellido"></small>

							</div>

							<div class="col-12">
								<label class="form-label">Email</label>
								<input type="email" name="email" id="regEmail" class="form-control" required>
								<small class="text-danger d-none" id="errorEmail"></small>

							</div>

							<div class="col-md-6">
								<label class="form-label">Contrase√±a</label>
								<div class="input-group">
									<input type="password" name="password" id="regPassword" class="form-control"
										required minlength="6" data-password>
									<button class="btn btn-light border" type="button" data-toggle-password><i
											class="bi bi-eye-slash" data-icon></i></button>
								</div>

								<small class="text-danger d-none" id="errorPassword"></small>

							</div>

							<div class="col-md-6">
								<label class="form-label">Repetir contrase√±a</label>
								<div class="input-group">
									<input type="password" id="regPassword2" class="form-control" required minlength="6"
										data-password>
									<button class="btn btn-light border" type="button" data-toggle-password><i
											class="bi bi-eye-slash" data-icon></i></button>
								</div>
								<small class="text-danger d-none" id="errorPassword2"></small>

							</div>

							<div class="col-md-6">
								<label class="form-label">Fecha de nacimiento</label>
								<input type="date" name="fechaNacimiento" id="regFechaNacimiento" class="form-control"
									required>
								<small class="text-danger d-none" id="errorFechaNacimiento"></small>

							</div>
							<div class="col-md-6">
								<label class="form-label">Telefono</label>
								<input type="tel" name="Telefono" id="regTelefono" class="form-control" required>
								<small class="text-danger d-none" id="errorTelefono"></small>

							</div>

							<div class="col-md-6">
								<label class="form-label">Nombre de su organizaci√≥n</label>
								<input type="text" name="nombreOrganizacion" id="regNombreOrganizacion"
									class="form-control" maxlength="100">
								<small class="text-danger d-none" id="errorNombreOrganizacion"></small>

							</div>

							<div class="col-md-6">
								<label class="form-label">Direcci√≥n de su organizaci√≥n</label>
								<input type="text" name="direccionOrganizacion" id="regDireccionOrganizacion"
									class="form-control" maxlength="100">
								<small class="text-danger d-none" id="errorDireccionOrganizacion"></small>

							</div>

							<div class="col-md-12">
								<label class="form-label">Foto de Perfil</label>
								<input type="file" name="imagen" id="regImagenPerfil" class="form-control"
									accept="image/*" />
								<small class="text-danger d-none" id="errorImagenPerfil"></small>
							</div>

						</div>
					</div>

					<div class="modal-footer">
						<button type="button" class="btn btn-outline-secondary"
							data-bs-dismiss="modal">Cancelar</button>
						<button type="submit" class="btn btn-success" id="btnRegistroOrganizador">Registro</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!-- üîπ MAPA -->
	<div id="map"></div>

	<!-- üîπ MODAL NUEVO/EDITAR EVENTO -->
	<div class="modal fade" id="nuevoEventoModal" tabindex="-1" aria-labelledby="nuevoEventoModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content">
				<form id="formEvento">
					<div class="modal-header bg-primary text-white">
						<h5 class="modal-title" id="tituloModalEvento">Crear Nuevo Evento</h5>
						<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
					</div>
					<div class="modal-body">
						<div id="eventoError" class="alert alert-danger d-none" role="alert"></div>
						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label">T√≠tulo</label>
								<input type="text" name="titulo" class="form-control" id="eventoTitulo" required
									maxlength="50" />
								<small class="invalid-feedback d-none" id="errorTitulo"></small>
							</div>

							<div class="col-md-6">
								<label class="form-label">Categor√≠a</label>
								<select name="categoriaId" id="eventoCategoriaId" class="form-select" required>
									<option value="">Selecciona una categor√≠a</option>
									<option value="1">M√∫sica</option>
									<option value="2">Deporte</option>
									<option value="3">Teatro</option>
								</select>
								<small class="invalid-feedback d-none" id="errorCategoria"></small>
							</div>

							<div class="col-12">
								<label class="form-label">Descripci√≥n</label>
								<textarea name="descripcion" id="eventoDescripcion" class="form-control" rows="3"
									maxlength="300" required></textarea>
								<small class="invalid-feedback d-none" id="errorDescripcion"></small>
							</div>

							<div class="col-md-6">
								<label class="form-label">Fecha de inicio</label>
								<input type="datetime-local" name="fechaInicio" id="eventoFechaInicio"
									class="form-control" required />
								<small class="invalid-feedback d-none" id="errorFechaInicio"></small>
							</div>

							<div class="col-md-6">
								<label class="form-label">Fecha de fin</label>
								<input type="datetime-local" name="fechaFin" id="eventoFechaFin" class="form-control"
									required />
								<small class="invalid-feedback d-none" id="errorFechaFin"></small>
							</div>

							<div class="col-12">
								<label class="form-label">Direcci√≥n</label>
								<div class="input-group mb-2">
									<input type="text" id="eventoDireccion" name="ubicacion" class="form-control"
										placeholder="Ej: Av. Corrientes 123, Buenos Aires" required />
									<button type="button" id="btnBuscarDireccion" class="btn btn-outline-primary">
										Buscar
									</button>
								</div>
								<small class="invalid-feedback d-none" id="errorDireccion"></small>
							</div>

							<!-- Mapa para seleccionar ubicaci√≥n -->
							<div id="mapaUbicacion" style="height: 300px; border-radius: 8px"></div>

							<!-- Campos ocultos para guardar coordenadas -->
							<input type="hidden" name="latitud" id="eventoLatitud" />
							<input type="hidden" name="longitud" id="eventoLongitud" />
							<small class="invalid-feedback d-none" id="errorLatitud"></small>
							<small class="invalid-feedback d-none" id="errorLongitud"></small>

							<div class="col-md-4">
								<label class="form-label">Precio</label>
								<input type="number" step="0.01" name="precio" id="eventoPrecio" class="form-control"
									placeholder="0 si es gratis" />
								<small class="invalid-feedback d-none" id="errorPrecio"></small>
							</div>

							<div class="col-md-6">
								<label class="form-label">Imagen del evento</label>
								<input type="file" name="imagen" id="eventoImagen" class="form-control"
									accept="image/*" />
								<img id="previewImagenEvento" src="" alt="Vista previa" class="mt-2 img-fluid rounded"
									style="display:none; max-width: 200px;">
								<small class="invalid-feedback d-none" id="errorImagen"></small>
							</div>

							<div class="col-md-6">
								<label class="form-label">Enlace externo (opcional)</label>
								<input type="url" name="urlVentaExterna" id="eventoUrlVentaExterna" class="form-control"
									placeholder="https://www.tuentrada.com/evento123" />
								<small class="invalid-feedback d-none" id="errorUrlVentaExterna"></small>
							</div>
							<div class="col-md-6 d-flex align-items-center">
								<div class="form-check mt-3">
									<input class="form-check-input" type="checkbox" name="requiereVerificarEdad"
										id="eventoRequiereVerificarEdad" />
									<label class="form-check-label" for="requiereVerificarEdad">
										Requiere verificaci√≥n de edad
									</label>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
							Cancelar
						</button>
						<button type="submit" class="btn btn-success" id="btnGuardarEvento">
							Crear Evento
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!-- üîπ MODAL FILTROS -->
	<div class="modal fade" id="filtrosModal" tabindex="-1" aria-labelledby="filtrosModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-md modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header bg-secondary text-white">
					<h5 class="modal-title">Filtros</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<form id="formFiltros">
						<div class="mb-3">
							<label class="form-label">Categor√≠as</label><br />
							<div class="form-check">
								<input type="checkbox" id="catMusica" class="form-check-input" />
								<label for="catMusica" class="form-check-label">M√∫sica</label>
							</div>
							<div class="form-check">
								<input type="checkbox" id="catDeporte" class="form-check-input" />
								<label for="catDeporte" class="form-check-label">Deporte</label>
							</div>
							<div class="form-check">
								<input type="checkbox" id="catTeatro" class="form-check-input" />
								<label for="catTeatro" class="form-check-label">Teatro</label>
							</div>
						</div>
						<div class="mb-3">
							<label class="form-label">Precio m√°ximo</label>
							<input type="number" class="form-control" placeholder="Ej: 1000" />
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
						Cerrar
					</button>
					<button type="submit" class="btn btn-primary">
						Aplicar filtros
					</button>
				</div>
			</div>
		</div>
	</div>

	<!-- MODAL MOSTRAR DETALLES COMPLETO DE EVENTOS / ORGANIZADOR (SOLO ADMINISTRADOR) -->
	<div class="modal fade" id="modalDetalleGenerico" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header bg-info text-white">
					<h5 class="modal-title"></h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body" id="modalDetalleBody">
					<!-- Se llena din√°micamente -->
				</div>
				<div class="modal-footer">
					<!-- Se llena din√°micamente -->
				</div>
			</div>
		</div>
	</div>
	
	
	
	<!-- MODAL ADMINISTRAR EVENTOS DE UN ORGANIZADOR -->
	<div class="modal fade" id="modalAdministrarEventosOrganizador" tabindex="-1"
		aria-labelledby="detalleEventoModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header bg-primary text-white">
					<h5 class="modal-title" id="detalleEventoModalLabel">Detalles del Evento</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
				</div>
				<div class="modal-body">
					<div class="table-responsive">
						<table id="tablaEventosOrganizador" class="table table-bordered table-striped align-middle">
							<thead class="table-dark">
								<tr>
									<th>T√≠tulo</th>
									<th>Descripci√≥n</th>
									<th>Categor√≠a</th>
									<th>Ubicaci√≥n</th>
									<th>Fecha creaci√≥n</th>
									<th>Fecha inicio</th>
									<th>Fecha fin</th>
									<th>Imagen</th>
									<th>Precio</th>
									<th>URL externa</th>
									<th>+18</th>
									<th>Validado</th>
									<th>Acciones</th>
								</tr>
							</thead>
							<tbody>
								<!-- Las filas se llenar√°n din√°micamente con JS -->
							</tbody>
						</table>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- MODAL PANEL DE ADMINISTRADOR -->
	<div class="modal fade" id="adminPanelModal" tabindex="-1" aria-labelledby="adminPanelLabel" aria-hidden="true">
		<div class="modal-dialog modal-xl modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header bg-dark text-white">
					<h5 class="modal-title" id="adminPanelLabel">Panel de Administraci√≥n</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
				</div>

				<div class="modal-body">
					<div class="table-responsive">
						<table class="table table-hover table-striped align-middle">
							<thead>
							</thead>
							<tbody id="eventosAdminBody">
								<!-- filas generadas por JS -->
							</tbody>
						</table>
					</div>
				</div>

				<div class="modal-footer">
					<button class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>

	<!-- TOASTS GENERICO PARA REGISTRO/LOGIN/EVENTOS -->
	<div class="position-fixed top-0 end-0 p-3" style="z-index: 1055">
		<div id="toastContainer"></div>
	</div>
	<!-- MODAL GEN√âRICO DE CONFIRMACI√ìN -->
	<div class="modal fade" id="modalConfirmacion" tabindex="-1" aria-labelledby="modalConfirmacionLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">

				<div class="modal-header" id="modalConfirmacionHeader">
					<h5 class="modal-title" id="modalConfirmacionLabel">T√≠tulo</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
				</div>

				<div class="modal-body" id="modalConfirmacionMensaje">Mensaje</div>

				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
					<button type="button" class="btn btn-primary" id="modalConfirmacionBtn">Aceptar</button>
				</div>

			</div>
		</div>
	</div>

	<!-- JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
	<script type="module">
		import {iniciarApp} from './js/app.js';

		document.addEventListener("DOMContentLoaded", iniciarApp);
	</script>
</body>

</html>